---
import { getCollection } from 'astro:content';
import PageLayout from '../layouts/PageLayout.astro';
import TeamCard from '../components/TeamCard.astro';

const allTeam = await getCollection('team');
const sortedTeam = allTeam.sort((a, b) => a.data.order - b.data.order);

const departments = [
  { id: 'property', label: 'Property', description: 'Our property team handles residential and commercial transactions across Devon and beyond.' },
  { id: 'private-client', label: 'Private Client', description: 'Our private client team advises on wills, probate, trusts, tax planning and lasting powers of attorney.' },
  { id: 'litigation', label: 'Litigation', description: 'Our litigation team provides expert representation in civil disputes, personal injury and family matters.' },
] as const;
---

<PageLayout
  title="Our Team"
  description="Meet the experienced team at Windeatts Solicitors. Qualified solicitors and legal professionals serving clients from Kingsbridge and Totnes, Devon."
  subtitle="Meet the people behind the practice. Our experienced team combines legal expertise with a personal, approachable service."
  breadcrumbs={[{ label: 'Our Team' }]}
>
  {departments.map((dept) => {
    const members = sortedTeam.filter((m) => m.data.department === dept.id);
    return members.length > 0 && (
      <section class="mb-16 last:mb-0">
        <div class="mb-8">
          <h2 class="font-(family-name:--font-heading) text-2xl font-bold text-navy">
            {dept.label}
          </h2>
          <p class="mt-2 text-gray-600">{dept.description}</p>
        </div>
        <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6">
          {members.map((member) => (
            <TeamCard
              name={member.data.name}
              role={member.data.role}
              title={member.data.title}
              photo={member.data.photo}
              href={`/team/${member.id}`}
              phone={member.data.phone}
              email={member.data.email}
            />
          ))}
        </div>
      </section>
    );
  })}

  <!-- CTA -->
  <div class="mt-8 bg-cream rounded-xl p-8 lg:p-12 text-center">
    <h2 class="font-(family-name:--font-heading) text-2xl font-bold text-navy">
      Get in touch with our team
    </h2>
    <p class="mt-3 text-gray-600 max-w-2xl mx-auto">
      Whether you need legal advice or simply want to find out how we can help, we would be delighted to hear from you.
    </p>
    <a
      href="/contact"
      class="mt-6 inline-block bg-gold hover:bg-gold-dark text-navy font-semibold px-6 py-3 rounded-lg transition-colors"
    >
      Contact us
    </a>
  </div>
</PageLayout>
